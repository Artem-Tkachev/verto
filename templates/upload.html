<h2>Загрузка тренировки</h2>
<form method="post" action="/upload">
  <input name="training_name" placeholder="Название тренировки" required><br>

  <label for="type">Тип тренировки:</label>
  <select name="type" id="type" required>
    <option value="">-- выберите тип --</option>
    <option value="run">Бег</option>
    <option value="bike">Велосипед</option>
    <option value="swim">Плавание</option>
    <option value="walk">Ходьба</option>
  </select><br>

  <input name="distance" placeholder="Дистанция (км)" type="number" step="0.1" required><br>
  <input name="duration" placeholder="Продолжительность (мин)" type="number" required><br>
  <div id="map" style="height: 400px; margin-bottom: 20px;"></div>
  <input type="hidden" name="map" id="map_data" required>

  <button type="submit">Загрузить</button>
</form>

<p><a href="/my_workouts_html">Посмотреть мои тренировки</a></p>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  let map = L.map('map').setView([55.75, 37.61], 10);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 18
  }).addTo(map);

  let route = [];
  let polyline = L.polyline(route, {color: 'red'}).addTo(map);

  map.on('click', function(e) {
    let latlng = e.latlng;
    route.push([latlng.lat, latlng.lng]);
    polyline.setLatLngs(route);

    document.getElementById('map_data').value = JSON.stringify(route);
  });
</script>